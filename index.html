<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SGC | Juzgados de Envigado</title>
    <link rel="stylesheet" href="css/styles.css?v=2.3">
    <link rel="stylesheet" href="css/sidebar_styles.css?v=2.3">
    <!-- Google Fonts -->
    <link
        href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;700;800;900&family=Open+Sans:wght@400;600;700&family=Poppins:wght@300;400;500;600;700&display=swap"
        rel="stylesheet">
    <!-- Font Awesome -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Extra Styles -->
    <link rel="stylesheet" href="css/survey_button_styles.css">
</head>

<body>

    <!-- Header -->
    <header>
        <div class="header-credit"><i class="fas fa-code"></i> Desarrollado por <span>Jaiber Holguín</span></div>
        <div class="logos-container">
            <div class="logo-left">
                <img src="images/ConsejoSuperiorDeLaJudicatura (1).png" alt="Consejo Superior de la Judicatura">
            </div>
            <div class="logo-center">
                <img src="images/logo_sigcma.png?v=2" alt="Logo SIGCMA">
            </div>
            <div class="logo-right">
                <img src="assets/logo_sgc.png" alt="SGC Envigado Logo">
            </div>
        </div>
        <nav class="nav-container">
            <button class="menu-toggle" aria-label="Abrir menú">
                <span></span>
                <span></span>
                <span></span>
            </button>
            <ul class="nav-links">
                <li><a href="javascript:void(0)" onclick="location.reload()">Inicio</a></li>
                <li><a href="#estrategia">Estrategia</a></li>
                <li><a href="#objetivos">Objetivos</a></li>
                <li><a href="#valores">Principios</a></li>
                <li><a href="#procesos">Mapa de Procesos</a></li>
                <li><a href="#contacto">Contacto</a></li>
                <li><a href="javascript:void(0)" onclick="openVideo()" class="btn-cta"
                        style="background-color: #28a745; margin-right: 15px;"><i class="fas fa-video"></i> El Sonido de
                        la Calidad</a></li>
                <li><a href="#" class="login-btn" onclick="openLoginModal()"><i class="fas fa-user-lock"></i> Acceso
                        Funcionarios</a></li>
            </ul>
        </nav>
    </header>

    <!-- Hero Section -->
    <section id="inicio" class="hero fade-in-section">
        <div class="hero-content">
            <h1>SISTEMA DE GESTIÓN DE LA CALIDAD JUZGADOS DE ENVIGADO</h1>
            <p>LA CALIDAD NOS UNE.</p>
        </div>
    </section>

    <!-- Estrategia Section -->
    <section id="estrategia" class="fade-in-section">
        <h2 class="section-title">Direccionamiento Estratégico</h2>
        <div class="grid-container">
            <div class="card">
                <h3>Misión</h3>
                <p>Garantizar la efectividad de los derechos y libertades ciudadanas y lograr la convivencia pacífica de
                    los
                    colombianos, a través de una administración de justicia orientada al ciudadano, pronta, cumplida,
                    eficiente,
                    eficaz, moderna, independiente y transparente, como uno de los pilares fundamentales del Estado
                    Social,
                    Participativo y Democrático de Derecho.</p>
            </div>
            <div class="card">
                <h3>Visión</h3>
                <p>En el año 2026 tendremos una justicia más oportuna, igualitaria e incluyente, sensible a las
                    diferentes
                    realidades regionales, garante de la legalidad y seguridad jurídica, que desarrolla su capital
                    humano y en la
                    que los ciudadanos confían y que satisface sus necesidades, a través de servicios digitales,
                    tecnología e
                    innovación.</p>
            </div>
            <div class="card">
                <h3>Política de Calidad</h3>
                <p>La administración de justicia en los Juzgados de Envigado cumple con eficacia, eficiencia y
                    efectividad, de
                    acuerdo con el Plan Sectorial de Desarrollo de la Rama Judicial, Óptimo servicio al ciudadano con
                    talento humano
                    competente, que garantiza la mejora continua de los procesos del Sistema de Gestión de Calidad;
                    promueve una
                    cultura de prevención, mitigación y control del riesgo, con el fin de fortalecer la prestación del
                    servicio.</p>
            </div>
        </div>
    </section>

    <!-- Objetivos Section -->
    <section id="objetivos" class="fade-in-section">
        <div class="objectives-container">
            <div class="objectives-left">
                <h2>OBJETIVOS</h2>
                <div class="footer-bar">
                    <p>SGAS: ANTISOBORNO Y ANTICORRUPCIÓN</p>
                    <div class="color-stripe"></div>
                </div>
            </div>
            <div class="objectives-right">
                <div class="sigcma-header">
                    <h3>SIGCMA</h3>
                    <p>- Coordinación Nacional -</p>
                </div>

                <div class="slider-container">
                    <ul class="objectives-slider">
                        <li class="slide active">
                            <div class="marker">a.</div>
                            <div class="slide-content">
                                <p>Cumplir los términos procesales establecidos por la Ley en las actuaciones surgidas
                                    en el desarrollo de la actividad judicial de los Juzgados.</p>
                                <span class="ref">(Directriz No. 01 de la Política de la Calidad)</span>
                            </div>
                        </li>
                        <li class="slide">
                            <div class="marker">b.</div>
                            <div class="slide-content">
                                <p>Garantizar la eficiencia, calidad y efectividad de la Administración de Justicia.</p>
                                <span class="ref">(Directriz No. 01 de la Política de la Calidad)</span>
                            </div>
                        </li>
                        <li class="slide">
                            <div class="marker">c.</div>
                            <div class="slide-content">
                                <p>Promover la utilización racional de los elementos y equipos disponibles para atender
                                    las actividades en cada unidad judicial.</p>
                                <span class="ref">(Directriz No. 02 de la Política de la Calidad)</span>
                            </div>
                        </li>
                        <li class="slide">
                            <div class="marker">d.</div>
                            <div class="slide-content">
                                <p>Establecer un clima organizacional adecuado para la correcta prestación del servicio.
                                </p>
                                <span class="ref">(Directriz No. 03 de la Política de la Calidad)</span>
                            </div>
                        </li>
                        <li class="slide" data-index="4">
                            <div class="marker">e</div>
                            <div class="slide-content">
                                <p>Brindar atención e información respetuosa, clara, accesible, completa, clara,
                                    oportuna y confiable a los usuarios de la administración de justicia, realizando
                                    medición y seguimiento permanente de la satisfacción del usuario.</p>
                            </div>
                        </li>
                        <li class="slide" data-index="5">
                            <div class="marker">f</div>
                            <div class="slide-content">
                                <p>Evidenciar en las decisiones judiciales la aplicación de las políticas de equidad y
                                    perspectiva de género. <br><strong>(Directriz No. 04 de la Política de la
                                        Calidad)</strong></p>
                            </div>
                        </li>
                    </ul>

                    <div class="slider-controls">
                        <button class="nav-btn prev-btn" onclick="prevSlide()">&#10094;</button>
                        <div class="slider-dots">
                            <span class="dot active" onclick="goToSlide(0)"></span>
                            <span class="dot" onclick="goToSlide(1)"></span>
                            <span class="dot" onclick="goToSlide(2)"></span>
                            <span class="dot" onclick="goToSlide(3)"></span>
                            <span class="dot" onclick="goToSlide(4)"></span>
                            <span class="dot" onclick="goToSlide(5)"></span>
                        </div>
                        <button class="nav-btn next-btn" onclick="nextSlide()">&#10095;</button>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <script>
        let currentSlide = 0;
        const slides = document.querySelectorAll('.slide');
        const dots = document.querySelectorAll('.dot');

        function showSlide(index) {
            slides.forEach(slide => slide.classList.remove('active'));
            dots.forEach(dot => dot.classList.remove('active'));

            if (index >= slides.length) currentSlide = 0;
            if (index < 0) currentSlide = slides.length - 1;

            slides[currentSlide].classList.add('active');
            dots[currentSlide].classList.add('active');
        }

        function nextSlide() {
            currentSlide++;
            showSlide(currentSlide);
        }

        function prevSlide() {
            currentSlide--;
            showSlide(currentSlide);
        }

        function goToSlide(index) {
            currentSlide = index;
            showSlide(currentSlide);
        }

        // Auto slide every 5 seconds
        setInterval(nextSlide, 8000);
    </script>

    <!-- Valores/Principios Section -->
    <section id="valores" style="background-color: #f0f2f5;" class="fade-in-section">
        <h2 class="section-title">Nuestros Principios</h2>
        <div class="values-list">
            <div class="value-item">
                <div class="value-icon"><i class="fas fa-lightbulb"></i></div>
                <h4>Iniciativa</h4>
            </div>
            <div class="value-item">
                <div class="value-icon"><i class="fas fa-hand-holding-heart"></i></div>
                <h4>Honestidad</h4>
            </div>
            <div class="value-item">
                <div class="value-icon"><i class="fas fa-balance-scale"></i></div>
                <h4>Equidad</h4>
            </div>
            <div class="value-item">
                <div class="value-icon"><i class="fas fa-hands-helping"></i></div>
                <h4>Solidaridad</h4>
            </div>
            <div class="value-item">
                <div class="value-icon"><i class="fas fa-handshake"></i></div>
                <h4>Respeto</h4>
            </div>
            <div class="value-item">
                <div class="value-icon"><i class="fas fa-cogs"></i></div>
                <h4>Laboriosidad</h4>
            </div>
            <div class="value-item">
                <div class="value-icon"><i class="fas fa-check-circle"></i></div>
                <h4>Responsabilidad</h4>
            </div>

        </div>
    </section>

    <!-- Mapa de Procesos Section -->
    <section id="procesos" class="fade-in-section">
        <h2 class="section-title">Mapa de Procesos</h2>
        <div class="process-map">
            <div class="interactive-map-container">
                <img src="images/mapa_procesos.jpg" alt="Mapa de Procesos - SGC Envigado" class="process-map-img">
                <!-- Ejemplo de zona activa: Planeación Estratégica -->
                <a href="javascript:void(0)"
                    onclick="openModal('images/planeacion_estrategica.png', 'Planeación Estratégica')"
                    class="map-hotspot hotspot-estrategia" title="Ver Planeación Estratégica"></a>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer id="contacto">
        <div class="footer-container">
            <div class="footer-col about">
                <h3>SGC | Juzgados Envigado</h3>
                <p>Comprometidos con la excelencia y la transparencia en la administración de justicia.</p>
                <div class="socials">
                    <a href="#"><i class="fab fa-facebook-f"></i></a>
                    <a href="#"><i class="fab fa-twitter"></i></a>
                    <a href="#"><i class="fab fa-instagram"></i></a>
                </div>
            </div>
            <div class="footer-col links">
                <h3>Enlaces Rápidos</h3>
                <ul>
                    <li><a href="#inicio">Inicio</a></li>
                    <li><a href="#estrategia">Estrategia</a></li>
                    <li><a href="#objetivos">Objetivos</a></li>
                    <li><a href="#procesos">Mapa de Procesos</a></li>
                </ul>
            </div>
            <div class="footer-col contact">
                <h3>Contáctanos</h3>
                <ul class="contact-info">
                    <li><i class="fas fa-map-marker-alt"></i> Carrera 43 # 38 sur 42, Envigado, Antioquia<br>Edificio
                        Alvaro Medina Ochoa</li>
                    <li><i class="fas fa-clock"></i> Lun - Vie: 8:00 AM - 5:00 PM</li>
                    <li><i class="fas fa-envelope"></i> cseradenvigado@cendoj.ramajudicial.gov.co</li>
                </ul>
            </div>
        </div>

        <div class="footer-bottom">
            <p>&copy; 2026 Rama Judicial. Todos los derechos reservados.</p>
            <div class="visitor-counter">
                <i class="fas fa-eye"></i> Visitas: <span id="counter-value">0</span>
            </div>
        </div>

        <!-- Image Modal -->
        <div id="imageModal" class="modal">
            <span class="close-modal">&times;</span>
            <img class="modal-content" id="modalImage">
            <div id="caption"></div>
        </div>


        <!-- Login Modal -->
        <div id="loginModal" class="modal">
            <div class="modal-content login-content">
                <span class="close-modal" onclick="closeLoginModal()"><i class="fas fa-times-circle"></i></span>
                <div class="login-header">
                    <img src="images/fondo_letras_blancas-.jpg" alt="SGC Logo"
                        style="height: 160px; margin-bottom: 20px; border-radius: 10px;">
                    <h2>Acceso Administrativo</h2>
                    <p>Sistema de Seguimiento a Términos</p>
                </div>
                <form id="loginForm" onsubmit="handleLogin(event)">
                    <div class="form-group">
                        <label for="username">Usuario</label>
                        <div class="input-icon">
                            <i class="fas fa-user"></i>
                            <input type="text" id="username" placeholder="Ingrese su usuario" required>
                        </div>
                    </div>
                    <div class="form-group">
                        <label for="password">Contraseña</label>
                        <div class="input-icon">
                            <i class="fas fa-lock"></i>
                            <input type="password" id="password" placeholder="Ingrese su contraseña" required>
                        </div>
                    </div>
                    <button type="submit" class="btn-premium-login">Ingresar</button>
                </form>
            </div>
        </div>

        <!-- Dashboard Section (Hidden by default) -->
        <div id="dashboard" class="dashboard-overlay" style="display: none;">
            <div class="dashboard-sidebar collapsed">
                <div class="sidebar-header">
                    <h3>SGC Envigado</h3>
                    <p>Panel de Control</p>
                    <button class="sidebar-toggle-btn" onclick="toggleSidebar()">
                        <i class="fas fa-bars"></i>
                    </button>
                </div>
                <ul class="sidebar-menu">
                    <li class="active has-submenu" id="nav-tutelas">
                        <a href="javascript:void(0)"
                            onclick="toggleSubmenu('submenu-tutelas'); switchModule('tutelas')">
                            <i class="fas fa-balance-scale-right"></i> <span>Seguimiento a Términos Tutelas</span>
                            <i class="fas fa-chevron-down submenu-arrow"></i>
                        </a>
                        <ul class="sub-menu" id="submenu-tutelas">
                            <li id="nav-estadisticas-tutelas">
                                <a href="javascript:void(0)" onclick="switchModule('estadisticas_tutelas')">
                                    <i class="fas fa-table"></i> <span>Estadística Tutelas</span>
                                </a>
                            </li>
                            <li id="nav-impugnacion">
                                <a href="javascript:void(0)" onclick="switchModule('impugnacion')">
                                    <i class="fas fa-share-square"></i> <span>Impugnación--Envío Corte</span>
                                </a>
                            </li>
                            <li id="nav-desacatos">
                                <a href="javascript:void(0)" onclick="switchModule('desacatos')">
                                    <i class="fas fa-exclamation-circle"></i> <span>Incidentes de Desacato</span>
                                </a>
                            </li>
                        </ul>
                    </li>
                    <li id="nav-demandas">
                        <a href="javascript:void(0)" onclick="switchModule('demandas')">
                            <i class="fas fa-gavel"></i> <span>Seguimiento a Términos Demandas</span>
                        </a>
                    </li>
                    <li id="nav-estadisticas">
                        <a href="javascript:void(0)" onclick="switchModule('estadisticas')">
                            <i class="fas fa-chart-pie"></i> <span>Estadísticas</span>
                        </a>
                    </li>
                    <li id="sidebarBtnUsers" style="display:none;">
                        <a href="javascript:void(0)" onclick="switchModule('users')">
                            <i class="fas fa-users-cog"></i> <span>Gestión Usuarios</span>
                        </a>
                    </li>
                    <li>
                        <a href="javascript:void(0)" onclick="openChangePasswordModal(); return false;">
                            <i class="fas fa-key"></i> <span>Cambiar Contraseña</span>
                        </a>
                    </li>
                    <li>
                        <a href="javascript:void(0)" onclick="logout(); return false;">
                            <i class="fas fa-sign-out-alt"></i> <span>Cerrar Sesión</span>
                        </a>
                    </li>
                </ul>
            </div>
            <div class="dashboard-content">
                <header class="dash-header">
                    <div class="header-logo-group">
                        <img src="images/ConsejoSuperiorDeLaJudicatura (1).png" alt="Consejo">
                        <img src="images/logo_sigcma.png?v=2" alt="SIGCMA">
                        <img src="images/LOGO_SGC_ENVIGADO.png" alt="SGC Envigado">
                        <div class="header-divider"></div>
                        <h2>Seguimiento a Términos</h2>
                    </div>

                    <div class="header-right" style="display: flex; flex-direction: column; align-items: flex-end;">
                        <span class="header-credit">Creado por Jaiber Holguín</span>
                        <span id="welcomeMsg" style="margin-right: 15px; font-weight: bold;">Hola, Funcionario</span>
                        <!-- User Button is in Sidebar -->
                    </div>
                </header>

                <!-- Statistics Section (Hidden by default) -->
                <div id="statistics-section" style="display: none; padding: 20px;">
                    <!-- Content preserved -->
                    <div class="card" style="padding: 20px;">
                        <h3 style="color: #004884; margin-bottom: 20px;">Estadísticas de Gestión</h3>
                        <!-- ... Charts content ... -->
                        <div
                            style="display: grid; grid-template-columns: 1fr 2fr 1fr; gap: 20px; text-align: center; margin-bottom: 25px;">
                            <!-- Using existing IDs to keep logic working -->
                            <div
                                style="background: linear-gradient(135deg, #28a745 0%, #1e7e34 100%); color: white; padding: 20px; border-radius: 12px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); position: relative; overflow: hidden; display: flex; flex-direction: column; justify-content: center;">
                                <i class="fas fa-gavel"
                                    style="font-size: 5rem; opacity: 0.1; position: absolute; left: -10px; bottom: -10px;"></i>
                                <h4 style="margin: 0; opacity: 0.9; font-weight: normal;">DEMANDAS</h4>
                                <h1 id="statsDemandasCount"
                                    style="margin: 5px 0 0 0; font-size: 2.5rem; font-weight: 800;">
                                    0</h1>
                            </div>
                            <div
                                style="background: white; border: 1px solid #ddd; padding: 20px; border-radius: 12px; display: flex; flex-direction: column; justify-content: center; align-items: center;">
                                <h5
                                    style="color: #666; margin: 0 0 5px 0; text-transform: uppercase; font-size: 0.8rem; letter-spacing: 1px;">
                                    Viendo estadísticas de:</h5>
                                <h2 id="statsJuzgadoName"
                                    style="color: #333; margin: 0; font-size: 1.5rem; font-weight: 700; text-transform: uppercase;">
                                    TODOS LOS JUZGADOS</h2>
                            </div>
                            <div
                                style="background: linear-gradient(135deg, #004884 0%, #002a4d 100%); color: white; padding: 20px; border-radius: 12px; box-shadow: 0 4px 10px rgba(0,0,0,0.1); position: relative; overflow: hidden; display: flex; flex-direction: column; justify-content: center;">
                                <i class="fas fa-balance-scale"
                                    style="font-size: 5rem; opacity: 0.1; position: absolute; right: -10px; bottom: -10px;"></i>
                                <h4 style="margin: 0; opacity: 0.9; font-weight: normal;">TUTELAS</h4>
                                <h1 id="statsTutelasCount"
                                    style="margin: 5px 0 0 0; font-size: 2.5rem; font-weight: 800;">0
                                </h1>
                            </div>
                        </div>
                        <!-- Reuse existing filter container -->
                        <div
                            style="display: flex; gap: 15px; margin-bottom: 20px; flex-wrap: wrap; align-items: flex-end; justify-content: center; background: #f8f9fa; padding: 15px; border-radius: 8px;">
                            <div style="display:flex; flex-direction: column; gap: 5px;">
                                <label style="font-size: 0.8rem; color: #666; font-weight: bold;">Rango de
                                    Fechas:</label>
                                <div style="display:flex; gap: 5px;">
                                    <input type="date" id="statFilterFechaInicio" class="form-control"
                                        style="max-width: 130px;" title="Desde" onchange="updateStatistics()">
                                    <input type="date" id="statFilterFechaFin" class="form-control"
                                        style="max-width: 130px;" title="Hasta" onchange="updateStatistics()">
                                </div>
                            </div>
                            <div style="display:flex; flex-direction: column; gap: 5px;">
                                <label style="font-size: 0.8rem; color: #666; font-weight: bold;">Despacho:</label>
                                <select id="statFilterJuzgado" class="form-control" style="max-width: 250px;"
                                    onchange="updateStatistics()">
                                    <option value="">Todos los Juzgados</option>
                                </select>
                            </div>
                            <div style="display:flex; flex-direction: column; gap: 5px; margin-left: 20px;">
                                <label style="font-size: 0.8rem; color: #666; font-weight: bold;">Ver en
                                    Gráfica:</label>
                                <div style="display:flex; gap: 15px;">
                                    <label style="cursor:pointer; display:flex; align-items:center; gap:5px;">
                                        <input type="checkbox" id="checkShowTutelas" checked
                                            onchange="updateStatistics()">
                                        <span style="color:#004884; font-weight:bold;">Tutelas</span>
                                    </label>
                                    <label style="cursor:pointer; display:flex; align-items:center; gap:5px;">
                                        <input type="checkbox" id="checkShowDemandas" checked
                                            onchange="updateStatistics()">
                                        <span style="color:#28a745; font-weight:bold;">Demandas</span>
                                    </label>
                                </div>
                            </div>
                            <button class="btn-primary" onclick="updateStatistics()"
                                style="background-color: #333; color: white; border: none; padding: 8px 15px; border-radius: 5px; align-self: flex-end;">
                                <i class="fas fa-sync-alt"></i> Actualizar
                            </button>
                        </div>
                        <div style="height: 400px; width: 100%; display: flex; justify-content: center;">
                            <canvas id="juzgadosChart"></canvas>
                        </div>
                    </div>
                </div>

                <!-- NEW USER MANAGEMENT SECTION -->
                <div id="user-management-section" style="display: none; padding: 20px;">
                    <div class="card" style="padding: 30px; background: white; border-radius: 20px;">
                        <h2 style="color: #1a237e; margin-bottom: 25px;"><i class="fas fa-users-cog"></i> Gestión de
                            Usuarios</h2>

                        <!-- Crear/Editar Usuario Form -->
                        <div
                            style="background: #f8fafc; padding: 25px; border-radius: 15px; border: 1px solid #e2e8f0; margin-bottom: 30px;">
                            <h4 style="color: #1e293b; margin-bottom: 15px;" id="userFormTitle">Crear Nuevo Usuario</h4>
                            <form id="userForm" onsubmit="handleCreateUser(event)"
                                style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px;">
                                <div class="form-group">
                                    <label style="color: #475569;">Usuario</label>
                                    <input type="text" id="newUsername" placeholder="ej: juzgado01" required
                                        class="form-control">
                                </div>
                                <div class="form-group">
                                    <label style="color: #475569;">Contraseña</label>
                                    <input type="text" id="newPassword" placeholder="Contraseña" required
                                        class="form-control">
                                </div>
                                <div class="form-group">
                                    <label style="color: #475569;">Rol de Acceso</label>
                                    <select id="newRole" class="form-control" onchange="toggleJuzgadoInput()">
                                        <option value="user">Usuario Juzgado</option>
                                        <option value="radicador">Radicador (Acceso Total)</option>
                                        <option value="radicador_tutelas">Radicador (Solo Tutelas)</option>
                                        <option value="radicador_demandas">Radicador (Solo Demandas)</option>
                                        <option value="admin">Administrador</option>
                                    </select>
                                </div>
                                <div class="form-group">
                                    <label style="color: #475569;">Nombre Juzgado</label>
                                    <input type="text" id="newJuzgado" placeholder="ej: Juzgado 05"
                                        class="form-control">
                                </div>
                                <div class="form-group">
                                    <label style="color: #475569;">Correo Institucional</label>
                                    <input type="email" id="newEmail"
                                        placeholder="ej: juzgado@cendoj.ramajudicial.gov.co" class="form-control">
                                </div>
                                <div
                                    style="grid-column: 1 / -1; display: flex; align-items: center; gap: 10px; padding: 10px 0;">
                                    <input type="checkbox" id="newVacancia"
                                        style="width: auto; height: 18px; width: 18px; cursor: pointer;">
                                    <label for="newVacancia"
                                        style="margin: 0; font-weight: 600; color: #1e293b; cursor: pointer;">Aplica
                                        Vacancia Judicial</label>
                                </div>
                                <div style="grid-column: 1 / -1; display: flex; gap: 10px; margin-top: 5px;">
                                    <button type="submit" class="btn-primary" style="flex: 1; padding: 12px;">Guardar
                                        Usuario</button>
                                    <button type="button" onclick="resetUserForm()" class="btn-danger"
                                        style="flex: 1; padding: 12px; display:none;" id="btnCancelUserEdit">Cancelar
                                        Edición</button>
                                </div>
                                <button type="button" onclick="ensureUsersExist()" class="btn-warning"
                                    style="grid-column: 1 / -1; margin-top: 10px; background: #bfa15f; border: none; padding: 12px;">
                                    <i class="fas fa-database"></i> Cargar Juzgados Base (Configuración Inicial)
                                </button>
                            </form>
                        </div>

                        <!-- Lista Usuarios -->
                        <h4 style="color: #1a237e; margin-bottom: 15px;"><i class="fas fa-list"></i> Usuarios Existentes
                        </h4>
                        <div class="table-responsive">
                            <table class="table" style="width: 100%;">
                                <thead style="background: #f1f5f9;">
                                    <tr>
                                        <th>Usuario</th>
                                        <th>Rol</th>
                                        <th>Juzgado</th>
                                        <th>Correo</th>
                                        <th>Vacancia</th>
                                        <th>Acciones</th>
                                    </tr>
                                </thead>
                                <tbody id="userListBody">
                                    <!-- JS fills this -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <!-- SECCIÓN INCIDENTES DE DESACATO -->
                <div id="desacatos-section" class="module-section" style="display: none; padding: 20px;">
                    <div class="card" style="padding: 30px; background: white; border-radius: 20px;">
                        <h2 class="mb-4 text-primary" style="color: #1a237e;"><i
                                class="fas fa-exclamation-circle me-2"></i> Incidentes de Desacato</h2>

                        <!-- PANEL DE CONTROL: BUSQUEDA Y MANUAL -->
                        <div class="row mb-4 justify-content-center g-4">
                            <div class="col-md-5 col-lg-4 mb-5" style="margin-bottom: 3rem !important;">
                                <label
                                    style="font-weight: 600; color: #004884; display:block; text-align:center;">Buscar
                                    por Radicado (23 dígitos):</label>
                                <div class="input-group shadow-sm" style="border-radius: 8px; overflow: hidden;">
                                    <input type="text" id="searchRadicadoDesacato" class="form-control border-end-0"
                                        placeholder="Ej: 05266..." maxlength="23" onkeyup="checkRadicadoDesacato(this)"
                                        style="border-radius: 8px 0 0 8px; border: 1px solid #ced4da;">
                                    <button class="btn-premium btn-premium-blue" onclick="searchRadicadoDesacatoBtn()"
                                        style="border-radius: 0 8px 8px 0; margin: 0; padding: 10px 20px; box-shadow: none;">
                                        <i class="fas fa-search"></i>
                                    </button>
                                </div>
                            </div>
                            <div class="col-md-3 offset-md-1 d-flex align-items-end justify-content-center ps-4">
                                <button class="btn-premium btn-premium-green" onclick="enableManualDesacato()"
                                    style="width: auto; min-width: 200px;">
                                    <i class="fas fa-pen me-2"></i> Ingresar Manualmente
                                </button>
                            </div>
                        </div>

                        <!-- FORMULARIO DE REGISTRO (Oculto inicialmente) -->
                        <form id="formDesacato"
                            style="display:none; background: #ffffff; padding: 25px; border-radius: 15px; margin-bottom: 30px; border: 1px solid #e0e0e0; box-shadow: 0 10px 25px rgba(0,0,0,0.05);">
                            <input type="hidden" id="desId"> <!-- ID para edición -->
                            <h5
                                style="color: #004884; margin-bottom: 20px; font-weight: 800; border-bottom: 2px solid #f0f0f0; padding-bottom: 10px;">
                                <i class="fas fa-file-contract me-2"></i> Incidente de Desacato
                            </h5>
                            <div class="row g-3">
                                <div class="col-md-6">
                                    <label class="form-label fw-bold text-muted small">Radicado</label>
                                    <input type="text" id="desRadicado" class="form-control fw-bold" readonly required
                                        style="background-color: #f8f9fa; color: #333; border: 1px solid #dee2e6;">
                                </div>
                                <!-- Reparto Field Removed -->
                                <div class="col-md-6">
                                    <label class="form-label fw-bold text-muted small">Accionante</label>
                                    <input type="text" id="desAccionante" class="form-control" readonly required
                                        style="background-color: #f8f9fa;">
                                </div>
                                <div class="col-md-6">
                                    <label class="form-label fw-bold text-muted small">Accionado</label>
                                    <input type="text" id="desAccionado" class="form-control" readonly required
                                        style="background-color: #f8f9fa;">
                                </div>
                                <div class="col-md-6">
                                    <label class="form-label fw-bold text-muted small">F. Fallo (Tutela)</label>
                                    <input type="date" id="desFechaFallo" class="form-control" readonly
                                        style="background-color: #f8f9fa;">
                                </div>
                                <div class="col-md-6">
                                    <label class="form-label fw-bold text-muted small">Decisión (Tutela)</label>
                                    <input type="text" id="desDecisionTutela" class="form-control" readonly
                                        style="background-color: #f8f9fa;">
                                </div>
                                <div class="col-md-6">
                                    <label class="form-label fw-bold text-muted small">Fecha Solicitud Desacato</label>
                                    <input type="date" id="desFechaSolicitud" class="form-control">
                                </div>
                                <div class="col-md-6">
                                    <label class="form-label fw-bold text-muted small">Fecha Apertura Incidente</label>
                                    <input type="date" id="desFechaApertura" class="form-control">
                                </div>
                                <div class="col-md-6">
                                    <label class="form-label fw-bold text-muted small">Fecha Sanción</label>
                                    <input type="date" id="desFechaSancion" class="form-control">
                                </div>
                                <div
                                    class="col-md-12 text-center mt-4 pt-3 border-top display-flex justify-content-center gap-3">
                                    <button type="button" class="btn-premium btn-premium-red me-3"
                                        onclick="closeDesacatoForm()" style="min-width: 150px;">
                                        <i class="fas fa-times me-2"></i> Cancelar
                                    </button>
                                    <button type="submit" class="btn-premium btn-premium-green"
                                        style="min-width: 150px;">
                                        <i class="fas fa-save me-2"></i> Guardar
                                    </button>
                                </div>
                            </div>
                        </form>

                        <!-- Contenedor Tabla -->
                        <div class="table-container fade-in-section">
                            <div class="table-responsive">
                                <table class="table table-hover align-middle"
                                    style="width: 100%; border-collapse: separate; border-spacing: 0;">
                                    <thead class="table-light">
                                        <tr>
                                            <th style="border-top-left-radius: 10px;">F. Fallo (Tutela)</th>
                                            <th>Radicado</th>
                                            <th>Accionante</th>
                                            <th>Accionado</th>
                                            <th>Decisión (Tutela)</th>
                                            <th>FECHA SOLICITUD DESACATO</th>
                                            <th>FECHA APERTURA INCIDENTE DE DESACATO</th>
                                            <th>FECHA SANCION</th>
                                            <th style="border-top-right-radius: 10px; width: 80px; text-align: center;">
                                                Acción</th>
                                        </tr>
                                    </thead>
                                    <tbody id="desacatosTableBody">
                                        <!-- Se llenará con JS o manualmente por ahora -->
                                        <tr>
                                            <td colspan="6" class="text-center text-muted">No hay registros de desacato
                                                aún.</td>
                                        </tr>
                                    </tbody>
                                </table>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- NEW MATRIX STATISTICS SECTION -->
                <div id="estadisticas-tutelas-section" style="display: none; padding: 20px;">
                    <div class="card" style="padding: 20px; margin-bottom: 20px;">
                        <div style="display:flex; justify-content:center; align-items:center;">
                            <h3
                                style="color: #004884; margin-bottom: 20px; text-transform: uppercase; font-weight: 800;">
                                ENTRADA TUTELAS</h3>
                        </div>

                        <div
                            style="display: flex; gap: 30px; align-items: flex-start; flex-wrap: wrap; justify-content: center;">
                            <div style="overflow-x: auto; text-align: left; min-width: 600px;">
                                <table class="table"
                                    style="border-collapse: collapse; width: auto; font-size: 0.85rem;">
                                    <thead>
                                        <tr style="background-color: #f2f2f2;">
                                            <th
                                                style="border: 1px solid #ddd; padding: 5px; background: #e9ecef; white-space: nowrap;">
                                                TIPOS PROCESOS</th>
                                            <th style="border: 1px solid #ddd; padding: 5px; text-align: center;">
                                                REPARTO</th>
                                            <th style="border: 1px solid #ddd; padding: 5px; text-align: center;">
                                                COMPETENCIA
                                            </th>
                                            <th style="border: 1px solid #ddd; padding: 5px; text-align: center;">
                                                REINGRESO POR
                                                NULIDAD O COMPETENCIA</th>
                                            <th style="border: 1px solid #ddd; padding: 5px; text-align: center;">
                                                ENTRADA
                                                IMPEDIMENTOS</th>
                                            <th style="border: 1px solid #ddd; padding: 5px; text-align: center;">OTRAS
                                                ENTRADAS
                                                NO EFECTIVAS</th>
                                            <th
                                                style="border: 1px solid #ddd; padding: 5px; background: #333; color: white; text-align: center;">
                                                TOTAL</th>
                                        </tr>
                                    </thead>
                                    <tbody id="matrixTableBody">
                                        <!-- Populated by JS -->
                                    </tbody>
                                    <tfoot id="matrixTableFoot" style="font-weight: bold; background-color: #e9ecef;">
                                        <!-- Totals -->
                                    </tfoot>
                                </table>
                            </div>

                            <!-- FILTRO FECHA ENTRADA -->
                            <div
                                style="background: #f8f9fa; padding: 20px; border-radius: 12px; border: 1px solid #ddd; min-width: 250px; box-shadow: 0 4px 10px rgba(0,0,0,0.05);">
                                <h5
                                    style="color: #004884; margin-top: 0; margin-bottom: 20px; font-size: 1rem; border-bottom: 2px solid #004884; padding-bottom: 8px; font-weight: 800; text-transform: uppercase;">
                                    <i class="fas fa-filter"></i> Filtrar por Fecha de Reparto
                                </h5>
                                <div class="form-group" style="margin-bottom: 15px;">
                                    <label
                                        style="font-size: 0.85rem; color: #333; display: block; margin-bottom: 5px; font-weight: 600;">Desde:</label>
                                    <input type="date" id="matrixEntradaDesde" class="form-control"
                                        style="font-size: 1rem; padding: 8px;" onchange="updateMatrixStatistics()">
                                </div>
                                <div class="form-group" style="margin-bottom: 20px;">
                                    <label
                                        style="font-size: 0.85rem; color: #333; display: block; margin-bottom: 5px; font-weight: 600;">Hasta:</label>
                                    <input type="date" id="matrixEntradaHasta" class="form-control"
                                        style="font-size: 1rem; padding: 8px;" onchange="updateMatrixStatistics()">
                                </div>
                                <button
                                    onclick="document.getElementById('matrixEntradaDesde').value=''; document.getElementById('matrixEntradaHasta').value=''; updateMatrixStatistics();"
                                    style="width: 100%; padding: 10px; font-size: 0.9rem; background: #004884; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: 600; transition: all 0.3s; box-shadow: 0 2px 4px rgba(0,0,0,0.2);">
                                    Limpiar Filtro
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- SALIDA DE TUTELAS TABLE -->
                    <div class="card" style="padding: 20px;">
                        <h3 style="color: #004884; margin-bottom: 20px; text-transform: uppercase; font-weight: 800;">
                            SALIDA DE TUTELAS</h3>
                        <div
                            style="display: flex; gap: 30px; align-items: flex-start; flex-wrap: wrap; justify-content: center;">
                            <div style="overflow-x: auto; text-align: left; min-width: 600px;">
                                <table class="table"
                                    style="border-collapse: collapse; width: auto; font-size: 0.85rem;">
                                    <thead>
                                        <tr style="background-color: #f2f2f2;">
                                            <th
                                                style="border: 1px solid #ddd; padding: 5px; background: #e9ecef; white-space: nowrap;">
                                                TIPOS PROCESOS</th>
                                            <th style="border: 1px solid #ddd; padding: 5px; text-align: center;">
                                                CONCEDE
                                            </th>
                                            <th style="border: 1px solid #ddd; padding: 5px; text-align: center;">NIEGA
                                            </th>
                                            <th style="border: 1px solid #ddd; padding: 5px; text-align: center;">
                                                DECLARA
                                                IMPROCEDENTE</th>
                                            <th style="border: 1px solid #ddd; padding: 5px; text-align: center;">
                                                FALTA DE COMPETENCIA</th>
                                            <th style="border: 1px solid #ddd; padding: 5px; text-align: center;">
                                                SALIDA IMPEDIMENTOS</th>
                                            <th style="border: 1px solid #ddd; padding: 5px; text-align: center;">HECHO
                                                SUPERADO</th>
                                            <th style="border: 1px solid #ddd; padding: 5px; text-align: center;">
                                                RECHAZA
                                            </th>
                                            <th style="border: 1px solid #ddd; padding: 5px; text-align: center;">
                                                RECHAZA
                                                POR CONOCIMIENTO PREVIO</th>
                                            <th style="border: 1px solid #ddd; padding: 5px; text-align: center;">
                                                RETIRO VOLUNTARIO
                                            </th>
                                            <th style="border: 1px solid #ddd; padding: 5px; text-align: center;">OTRAS
                                                SALIDAS NO EFECTIVAS
                                            </th>
                                            <th
                                                style="border: 1px solid #ddd; padding: 5px; background: #333; color: white; text-align: center;">
                                                TOTAL</th>
                                        </tr>
                                    </thead>
                                    <tbody id="matrixSalidaTableBody">
                                        <!-- Populated by JS -->
                                    </tbody>
                                    <tfoot id="matrixSalidaTableFoot"
                                        style="font-weight: bold; background-color: #e9ecef;">
                                        <!-- Totals -->
                                    </tfoot>
                                </table>
                            </div>

                            <!-- FILTRO FECHA SALIDA -->
                            <div
                                style="background: #f8f9fa; padding: 20px; border-radius: 12px; border: 1px solid #ddd; min-width: 250px; box-shadow: 0 4px 10px rgba(0,0,0,0.05);">
                                <h5
                                    style="color: #004884; margin-top: 0; margin-bottom: 20px; font-size: 1rem; border-bottom: 2px solid #004884; padding-bottom: 8px; font-weight: 800; text-transform: uppercase;">
                                    <i class="fas fa-filter"></i> Filtrar por Fecha de Fallo
                                </h5>
                                <div class="form-group" style="margin-bottom: 15px;">
                                    <label
                                        style="font-size: 0.85rem; color: #333; display: block; margin-bottom: 5px; font-weight: 600;">Desde:</label>
                                    <input type="date" id="matrixSalidaDesde" class="form-control"
                                        style="font-size: 1rem; padding: 8px;" onchange="updateMatrixStatistics()">
                                </div>
                                <div class="form-group" style="margin-bottom: 20px;">
                                    <label
                                        style="font-size: 0.85rem; color: #333; display: block; margin-bottom: 5px; font-weight: 600;">Hasta:</label>
                                    <input type="date" id="matrixSalidaHasta" class="form-control"
                                        style="font-size: 1rem; padding: 8px;" onchange="updateMatrixStatistics()">
                                </div>
                                <button
                                    onclick="document.getElementById('matrixSalidaDesde').value=''; document.getElementById('matrixSalidaHasta').value=''; updateMatrixStatistics();"
                                    style="width: 100%; padding: 10px; font-size: 0.9rem; background: #004884; color: white; border: none; border-radius: 6px; cursor: pointer; font-weight: 600; transition: all 0.3s; box-shadow: 0 2px 4px rgba(0,0,0,0.2);">
                                    Limpiar Filtro
                                </button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- NEW IMPUGNACION / ENVIO CORTE SECTION -->
                <div id="impugnacion-section" style="display: none; padding: 20px;">
                    <div class="card" style="padding: 20px; margin-bottom: 20px;">
                        <h3 style="color: #004884; margin-bottom: 20px; text-transform: uppercase; font-weight: 800;">
                            ENVIO AL SUPERIOR</h3>
                        <div style="overflow-x: auto; width: 80%; margin: 0 auto;">
                            <!-- Tabla Superior -->
                            <table class="table" style="width: 100%; border-collapse: collapse; font-size: 0.9rem;">
                                <thead>
                                    <tr style="background-color: #e9ecef;">
                                        <th style="border: 1px solid #ddd; padding: 6px; white-space: nowrap;">
                                            Radicado</th>
                                        <th
                                            style="border: 1px solid #ddd; padding: 3px; max-width: 300px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">
                                            Accionante</th>
                                        <th
                                            style="border: 1px solid #ddd; padding: 3px; max-width: 300px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">
                                            Accionado</th>
                                        <th style="border: 1px solid #ddd; padding: 6px; white-space: nowrap;">
                                            F. Límite Impugnación</th>
                                        <th
                                            style="border: 1px solid #ddd; padding: 3px; text-align: center; width: 1%; white-space: nowrap;">
                                            Alerta</th>
                                        <th
                                            style="border: 1px solid #ddd; padding: 3px; text-align: center; width: 1%; white-space: nowrap;">
                                            ENVIADO</th>
                                    </tr>
                                </thead>
                                <tbody id="tableSuperiorBody">
                                    <!-- Populated by JS -->
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <div class="card" style="padding: 20px;">
                        <h3 style="color: #004884; margin-bottom: 20px; text-transform: uppercase; font-weight: 800;">
                            ENVIO A LA CORTE</h3>
                        <div style="overflow-x: auto; width: 80%; margin: 0 auto;">
                            <!-- Tabla Inferior -->
                            <table class="table" style="width: 100%; border-collapse: collapse; font-size: 0.9rem;">
                                <thead>
                                    <tr style="background-color: #e9ecef;">
                                        <th style="border: 1px solid #ddd; padding: 6px; white-space: nowrap;">
                                            Radicado</th>
                                        <th
                                            style="border: 1px solid #ddd; padding: 3px; max-width: 300px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">
                                            Accionante</th>
                                        <th
                                            style="border: 1px solid #ddd; padding: 3px; max-width: 300px; overflow: hidden; text-overflow: ellipsis; white-space: nowrap;">
                                            Accionado</th>
                                        <th
                                            style="border: 1px solid #ddd; padding: 3px; text-align: center; width: 1%; white-space: nowrap;">
                                            Alerta</th>
                                        <th
                                            style="border: 1px solid #ddd; padding: 3px; text-align: center; width: 1%; white-space: nowrap;">
                                            ENVIADO</th>
                                    </tr>
                                </thead>
                                <tbody id="tableCorteBody">
                                    <!-- Populated by JS -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>

                <div class="dash-container" id="main-dash-container">
                    <!-- Data Entry Form -->
                    <div class="data-form-card">
                        <h3
                            style="text-align: center; text-transform: uppercase; color: #333; margin-bottom: 2rem; font-weight: 800; letter-spacing: 1px;">
                            Nuevo Registro
                        </h3>

                        <!-- PDF Import Section (Initially Hidden) -->
                        <div id="pdfImportContainer" class="pdf-import-banner" style="display: none;">
                            <h5 style="margin-bottom: 10px; color: #333; font-weight: bold;"><i class="fas fa-file-pdf"
                                    style="color: #dc3545; font-size: 1.2rem;"></i> Carga
                                Automática (Acta de Reparto)</h5>
                            <p style="font-size: 0.9rem; margin-bottom: 10px; color: #666;">Seleccione el archivo
                                PDF del
                                acta de reparto para diligenciar automáticamente el formulario.</p>
                            <button type="button" class="btn-sm"
                                style="background-color: #dc3545; color: white; border: none; padding: 8px 15px; border-radius: 5px; cursor: pointer; font-weight: bold;"
                                onclick="document.getElementById('actaPdfInput').click()">
                                <i class="fas fa-upload"></i> Seleccionar Acta PDF
                            </button>
                            <input type="file" id="actaPdfInput" accept=".pdf" style="display:none"
                                onchange="window.processActaPDF(this)">
                            <span id="pdfStatus" style="margin-left: 10px; font-weight: bold; color: #dc3545;"></span>
                        </div>

                        <form id="terminosForm" onsubmit="handleFormSubmit(event)">
                            <div class="form-grid">
                                <!-- 1. ASIGNAR JUZGADO (Para Radicador) - MOVIDO AL INICIO -->
                                <div class="form-group" id="divJuzgadoDestino"
                                    style="display:none; grid-column: span 2;">
                                    <label style="color: #bfa15f; font-weight: bold;">1. ASIGNAR A JUZGADO</label>
                                    <select id="juzgadoDestino" class="form-control" required>
                                        <option value="">Cargando Juzgados...</option>
                                    </select>
                                </div>

                                <div class="form-group">
                                    <label>Radicado</label>
                                    <div class="input-group-radicado">
                                        <input type="text" id="radicadoResto" class="form-control"
                                            placeholder="05266311000220260006300 (23 dígitos)" minlength="23"
                                            maxlength="23" pattern="\d{23}"
                                            title="Debe tener exactamente 23 dígitos numéricos" required
                                            oninput="this.value = this.value.replace(/[^0-9]/g, '')">
                                    </div>
                                </div>

                                <div class="form-group">
                                    <label>Fecha Reparto</label>
                                    <input type="date" id="fechaReparto" class="form-control" style="max-width: 200px;"
                                        required>
                                </div>

                                <div class="form-group">
                                    <label>Accionante</label>
                                    <input type="text" id="accionante" class="form-control"
                                        placeholder="Nombre Completo" required
                                        oninput="this.value = this.value.toUpperCase().replace(/[0-9]/g, '')">
                                </div>
                                <div class="form-group">
                                    <label>Doc. Id. Accionante</label>
                                    <input type="text" id="idAccionante" class="form-control" placeholder="Solo números"
                                        pattern="[0-9]+" title="Solo números permitidos"
                                        oninput="this.value = this.value.replace(/[^0-9]/g, '')">
                                </div>
                                <div class="form-group">
                                    <label>Accionado</label>
                                    <input type="text" id="accionado" class="form-control" placeholder="Nombre Completo"
                                        required oninput="this.value = this.value.toUpperCase().replace(/[0-9]/g, '')">
                                </div>

                                <div class="form-group">
                                    <label>Doc. Id. Accionado</label>
                                    <input type="text" id="idAccionado" class="form-control" placeholder="Solo números"
                                        pattern="[0-9]+" title="Solo números permitidos"
                                        oninput="this.value = this.value.replace(/[^0-9]/g, '')">
                                </div>

                                <!-- Spacer removed -->

                                <div class="form-group">
                                    <label>Tipo de Ingreso</label>
                                    <select id="ingreso" class="form-control">
                                        <option value="">Seleccione...</option>
                                        <option value="Reparto">Reparto</option>
                                        <option value="Competencia">Competencia</option>
                                        <option value="Reingreso por Nulidad o por Competencia">Reingreso por
                                            Nulidad o por
                                            Competencia</option>
                                        <option value="Entrada Impedimentos">Entrada Impedimentos</option>
                                        <option value="Otras Entradas no Efectivas">Otras Entradas no Efectivas
                                        </option>
                                    </select>
                                </div>

                                <div class="form-group" id="group-diaSiete">
                                    <label>Día Siete (Límite)</label>
                                    <input type="date" id="diaSiete" class="form-control" readonly
                                        style="background-color: #f0f0f0;">
                                </div>

                                <div class="form-group" id="group-diaDiez">
                                    <label>Día Diez (Límite)</label>
                                    <input type="date" id="diaDiez" class="form-control" readonly
                                        style="background-color: #f0f0f0;">
                                </div>

                                <div class="form-group" id="group-asignadoA">
                                    <label>Asignado A</label>
                                    <input type="text" id="asignadoA" class="form-control"
                                        placeholder="Nombre funcionario">
                                </div>

                                <div class="form-group" id="group-derecho">
                                    <label>Derecho Vulnerado</label>
                                    <select id="derecho" class="form-control">
                                        <option value="">Seleccione...</option>
                                        <option value="SALUD">SALUD</option>
                                        <option value="SEGURIDAD SOCIAL">SEGURIDAD SOCIAL</option>
                                        <option value="VIDA">VIDA</option>
                                        <option value="MÍNIMO VITAL">MÍNIMO VITAL</option>
                                        <option value="IGUALDAD">IGUALDAD</option>
                                        <option value="EDUCACIÓN">EDUCACIÓN</option>
                                        <option value="DEBIDO PROCESO">DEBIDO PROCESO</option>
                                        <option value="DERECHO DE PETICIÓN">DERECHO DE PETICIÓN</option>
                                        <option value="DERECHO A LA INFORMACIÓN PÚBLICA">DERECHO A LA INFORMACIÓN
                                            PÚBLICA
                                        </option>
                                        <option value="CONTRA PROVIDENCIAS JUDICIALES">CONTRA PROVIDENCIAS JUDICIALES
                                        </option>
                                        <option value="MEDIO AMBIENTE">MEDIO AMBIENTE</option>
                                        <option value="OTROS">OTROS</option>
                                    </select>
                                </div>

                                <div class="form-group" id="group-genero">
                                    <label>Perspectiva de Género</label>
                                    <select id="genero" class="form-control">
                                        <option value="">Seleccione...</option>
                                        <option value="NO">NO</option>
                                        <option value="SI">SÍ</option>
                                    </select>
                                </div>

                                <div class="form-group" id="group-fechaFallo">
                                    <label>Fecha Fallo (Sentencia)</label>
                                    <input type="date" id="fechaNotificacion" class="form-control">
                                </div>

                                <div class="form-group" id="group-decision">
                                    <label>Decisión de Fondo</label>
                                    <select id="decision" class="form-control">
                                        <option value="">Pendiente...</option>
                                        <option value="CONCEDE">CONCEDE</option>
                                        <option value="NIEGA">NIEGA</option>
                                        <option value="DECLARA IMPROCEDENTE">DECLARA IMPROCEDENTE</option>
                                        <option value="FALTA DE COMPETENCIA">FALTA DE COMPETENCIA</option>
                                        <option value="SALIDA IMPEDIMENTOS">SALIDA IMPEDIMENTOS</option>
                                        <option value="HECHO SUPERADO">HECHO SUPERADO</option>
                                        <option value="RECHAZA">RECHAZA</option>
                                        <option value="RECHAZA POR CONOCIMIENTO PREVIO (REMITE A OTROS DESPACHOS)">
                                            RECHAZA
                                            POR CONOCIMIENTO PREVIO (REMITE A OTROS DESPACHOS)</option>
                                        <option value="RETIRO VOLUNTARIO">RETIRO VOLUNTARIO</option>
                                        <option value="OTRAS SALIDAS NO EFECTIVAS">OTRAS SALIDAS NO EFECTIVAS</option>
                                    </select>
                                </div>

                                <div class="form-group" id="group-notificacionFallo">
                                    <label>NOTIFICACION FALLO</label>
                                    <input type="date" id="notificacionFallo" class="form-control">
                                </div>

                                <div class="form-group" id="group-impugno">
                                    <label>¿Impugnó?</label>
                                    <select id="impugno" class="form-control">
                                        <option value="">Seleccione...</option>
                                        <option value="NO">NO</option>
                                        <option value="SI">SÍ</option>
                                    </select>
                                </div>

                                <div class="form-group" id="group-fechaLimiteImpugnacion">
                                    <label>Fecha Límite Impugnación</label>
                                    <input type="date" id="fechaLimiteImpugnacion" class="form-control" readonly
                                        style="background-color: #f0f0f0;">
                                </div>

                                <div class="form-group">
                                    <label>Observaciones</label>
                                    <textarea id="observaciones" class="form-control" rows="1"
                                        placeholder="Comentarios adicionales... (Opcional)"></textarea>
                                </div>


                            </div>

                            <div style="display:flex; justify-content:center; align-items: center; gap: 15px;">
                                <!-- INDICADOR DE EDICIÓN (AHORA JUNTO A LOS BOTONES) -->
                                <div id="editModeIndicator" style="display:none;">
                                    <span
                                        style="background-color: #dc3545; color: white; padding: 8px 15px; border-radius: 8px; font-weight: bold; font-size: 0.85rem; display: flex; align-items: center; gap: 8px; box-shadow: 0 4px 6px rgba(0,0,0,0.1);">
                                        <i class="fas fa-edit"></i> MODO EDICIÓN
                                    </span>
                                </div>

                                <button type="submit" class="btn-success">Guardar Registro</button>
                                <button type="button" id="cancelEditBtn" onclick="window.resetForm()" class="btn-danger"
                                    style="display:none;">Cancelar</button>
                            </div>
                        </form>
                    </div>

                    <!-- Data Table -->
                    <div class="data-table-card">
                        <div style="display: flex; align-items: center; margin-bottom: 10px;">
                            <h3 style="margin:0;">Seguimiento de Tutelas</h3>
                            <span id="totalCount" class="total-badge"><i class="fas fa-layer-group"></i> Total:
                                0</span>
                        </div>

                        <!-- Toolbar: Buscador y Exportar -->
                        <div class="table-toolbar"
                            style="display: flex; flex-wrap: wrap; justify-content: space-between; margin-bottom: 15px; gap: 10px; align-items: center;">
                            <div
                                style="display: flex; gap: 15px; flex: 1; min-width: 400px; flex-wrap: wrap; align-items: center;">

                                <!-- 1. BUSCADOR GENERAL (Más grande) -->
                                <div style="flex: 2; min-width: 250px;">
                                    <label for="searchInput"
                                        style="font-size: 0.8rem; color: #666; margin-bottom: 2px;">Buscar
                                        (Radicado,
                                        Partes...)</label>
                                    <input type="text" id="searchInput" placeholder="🔍 Escribe para buscar..."
                                        style="width: 100%; padding: 10px 15px; border-radius: 6px; border: 1px solid #aaa; font-size: 1rem; box-shadow: inset 0 1px 3px rgba(0,0,0,0.1);">
                                </div>

                                <!-- 2. FILTRO DOCUMENTO (Cédula/NIT) -->
                                <div style="flex: 2; min-width: 250px;">
                                    <label for="filterDocumento"
                                        style="font-size: 0.8rem; color: #666; margin-bottom: 2px;">
                                        Buscar por Cédula/NIT
                                    </label>
                                    <input type="text" id="filterDocumento" onkeyup="filterAndRender()"
                                        placeholder="Ingrese número..."
                                        style="width: 100%; padding: 10px 15px; border-radius: 6px; border: 1px solid #aaa; font-size: 1rem;">
                                </div>

                                <!-- 3. FILTRO FECHA -->
                                <div style="flex: 1; min-width: 150px;">
                                    <label for="filterRadicadoAnio"
                                        style="font-size: 0.8rem; color: #666; margin-bottom: 2px;">Año y
                                        Consecutivo</label>
                                    <input type="text" id="filterRadicadoAnio" placeholder="Ej: 202600001"
                                        oninput="filterAndRender()"
                                        style="width: 100%; padding: 10px; border-radius: 6px; border: 1px solid #aaa; font-size: 1rem;">
                                </div>

                                <div style="flex: 1; min-width: 150px;">
                                    <label for="filterFecha"
                                        style="font-size: 0.8rem; color: #666; margin-bottom: 2px;">Fecha
                                        Reparto</label>
                                    <input type="date" id="filterFecha" onchange="filterAndRender()"
                                        style="width: 100%; padding: 10px; border-radius: 6px; border: 1px solid #aaa; font-size: 1rem;">
                                </div>

                                <!-- 4. FILTRO JUZGADO -->
                                <div id="group-filter-juzgado" style="flex: 2; min-width: 250px;">
                                    <label for="filterJuzgadoTabla"
                                        style="font-size: 0.8rem; color: #666; margin-bottom: 2px;">Filtrar por
                                        Despacho</label>
                                    <select id="filterJuzgadoTabla" class="form-control" onchange="filterAndRender()"
                                        style="width: 100%; padding: 10px; border-radius: 6px; border: 1px solid #aaa; font-size: 1rem;">
                                        <option value="">Todos los Despachos</option>
                                    </select>
                                </div>

                            </div>
                            <button id="importBtn" onclick="document.getElementById('excelInput').click()"
                                class="btn-premium btn-premium-info" style="width: auto;">
                                <i class="fas fa-file-import"></i> Importar Excel
                            </button>
                            <input type="file" id="excelInput" accept=".xlsx, .xls" style="display:none"
                                onchange="handleExcelUpload(this)">

                            <button id="exportBtn" onclick="exportToExcel()" class="btn-premium btn-premium-green"
                                style="width: auto;">
                                <i class="fas fa-file-excel"></i> Exportar
                            </button>
                        </div>

                        <div class="table-responsive">
                            <table class="table" id="tablaTerminos">
                                <thead>
                                    <tr>
                                        <th>F. Reparto</th>
                                        <th id="colJuzgadoHeader" style="display:none;">Juzgado</th>
                                        <th>Radicado</th>
                                        <th>Accionante</th>
                                        <th>Doc. Id. Accionante</th>
                                        <th>Accionado</th>
                                        <th>Doc. Id. Accionado</th>
                                        <th id="colAsignado">Asignado</th>
                                        <th id="colFallo">F. Fallo</th>
                                        <th id="colNotificacionFallo">Notificación Fallo</th>
                                        <th id="colDia10">Día 10</th>
                                        <th id="colFechaLimiteImpugnacion">F. Límite Impugnación</th>
                                        <th id="colCumplio">¿Cumplió?</th>
                                        <th id="colAlerta">Alerta</th>
                                        <th id="colDecision">Decisión</th>
                                        <th id="colDerecho">Derecho</th>
                                        <th id="colGenero">Género</th>
                                        <th id="colImpugno">Impugnó</th>
                                        <th id="colObservaciones" style="display:none;">Observaciones</th>
                                        <th>Acciones</th>
                                    </tr>
                                </thead>
                                <tbody id="terminosTableBody">
                                    <!-- Data rows will populate here -->
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Chart.js CDN -->
        <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
        </div>
        </div>



        <!-- MODAL CAMBIAR CONTRASEÑA PROPIA -->
        <div id="changePasswordModal" class="modal">
            <div class="modal-content login-content" style="max-width: 400px;">
                <span class="close-modal" onclick="closeChangePasswordModal()">&times;</span>
                <div class="login-header">
                    <h3><i class="fas fa-key"></i> Cambiar Mi Contraseña</h3>
                </div>
                <form id="changePasswordForm" onsubmit="handleChangePassword(event)">
                    <div class="form-group">
                        <label>Contraseña Actual</label>
                        <input type="password" id="currentPassword" class="form-control" required
                            placeholder="Ingrese su contraseña actual">
                    </div>
                    <div class="form-group">
                        <label>Nueva Contraseña</label>
                        <input type="password" id="newOwnPassword" class="form-control" required minlength="4"
                            placeholder="Nueva contraseña">
                    </div>
                    <button type="submit" class="btn-primary" style="width:100%">Actualizar</button>
                </form>
            </div>
        </div>

        <!-- Firebase SDKs (Compat version for easier direct usage) -->
        <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
        <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
        <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-auth-compat.js"></script>

        <!-- PDF.js for parsing Actas -->
        <script src="https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.4.120/pdf.min.js"></script>
        <script>
            // Initialize PDF.js worker
            pdfjsLib.GlobalWorkerOptions.workerSrc = 'https://cdnjs.cloudflare.com/ajax/libs/pdf.js/3.4.120/pdf.worker.min.js';
        </script>

        <!-- History Modal -->
        <div id="historyModal" class="modal">
            <div class="modal-content" style="max-width: 800px; background-color: #212529; color: white;">
                <span class="close-modal" onclick="closeHistoryModal()">&times;</span>
                <div class="login-header" style="text-align: center; margin-bottom: 2rem;">
                    <h2 style="color: #D4AF37;"><i class="fas fa-history"></i> Historial de Cambios</h2>
                    <p style="color: #ccc;">Versiones anteriores de este registro</p>
                </div>
                <div style="overflow-x: auto;">
                    <table class="table" style="width: 100%; color: white;">
                        <thead>
                            <tr style="border-bottom: 2px solid #444;">
                                <th style="color: #D4AF37;">Fecha</th>
                                <th style="color: #D4AF37;">Usuario</th>
                                <th style="color: #D4AF37;">Acción</th>
                                <th style="color: #D4AF37;">Opciones</th>
                            </tr>
                        </thead>
                        <tbody id="historyTableBody">
                            <!-- Populated by JS -->
                        </tbody>
                    </table>
                </div>
            </div>
        </div>

        <!-- ============================================
     MEJORAS SGC v2.0
     AGREGAR EN ESTE ORDEN (IMPORTANTE)
     ============================================ -->

        <!-- 1. Notificaciones -->
        <script src="js/notifications.js"></script>

        <!-- 2. Modal de Progreso -->
        <script src="js/progress-modal.js"></script>

        <!-- 3. Exportación Excel -->
        <script src="js/excel-export.js"></script>

        <!-- 4. Importación Excel -->
        <script src="js/excel-import-improved.js"></script>

        <!-- 5. Filtros Avanzados -->
        <script src="js/advanced-filters.js"></script>

        <!-- 6. Modo Oscuro -->
        <script src="js/dark-mode.js"></script>

        <!-- 7. Auditoría -->
        <script src="js/audit-system.js"></script>

        <!-- TU SCRIPT PRINCIPAL (DEBE IR AL FINAL) -->
        <script src="js/script.js?v=2.3"></script>
        <script src="js/user_management.js"></script>
        <script src="js/import_logic.js"></script>

        <!-- Custom JavaScript Handle -->
        <script>
            // Close modals when clicking outside
            window.onclick = function (event) {
                const imageModal = document.getElementById('imageModal');
                if (event.target == imageModal) {
                    imageModal.style.display = "none";
                }
                const loginModal = document.getElementById('loginModal');
                if (event.target == loginModal) {
                    closeLoginModal();
                }
            }
        </script>
        <!-- Video Modal -->
        <div id="videoModal" class="modal" style="display: none; align-items: center; justify-content: center;">
            <div class="modal-content"
                style="width: 90%; max-width: 1100px; padding: 0; background: black; overflow: hidden; border-radius: 15px; margin: auto; position: relative; box-shadow: 0 0 50px rgba(0,0,0,0.8);">
                <span class="close-modal" onclick="closeVideo()"
                    style="top: 15px; right: 25px; font-size: 3rem; color: white; text-shadow: 0 0 15px rgba(0,0,0,0.9); z-index: 100;">&times;</span>
                <div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
                    <iframe id="videoPlayer"
                        style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border: none;" src=""
                        allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"
                        allowfullscreen>
                    </iframe>
                </div>
            </div>
        </div>
</body>

</html>